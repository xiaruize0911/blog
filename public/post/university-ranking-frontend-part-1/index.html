<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="noindex, nofollow"><title>University Ranking Frontend Deep Dive (Part 1): Navigation Architecture & Search Implementation | xiaruize's Blog</title><meta name=keywords content="React Native,Navigation,Search,Vibe Coding,Implementation"><meta name=description content="Part 1 of our deep dive into the University Ranking Frontend. We explore the navigation orchestration in App.js, implement the SearchScreen with real-time filtering and bottom sheet modals, and build the DetailPage for university profiles."><meta name=author content><link rel=canonical href=http://localhost:1313/post/university-ranking-frontend-part-1/><link crossorigin=anonymous href=/assets/css/stylesheet.e1f5c4cae44599655f7ff95195ff89c8cb3adbda94f2b1581a434ab2b4d4e6cf.css integrity="sha256-4fXEyuRFmWVff/lRlf+JyMs629qU8rFYGkNKsrTU5s8=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/post/university-ranking-frontend-part-1/><link rel=alternate hreflang=zh href=http://localhost:1313/zh/post/university-ranking-frontend-part-1/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css integrity=sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js integrity=sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"\\[",right:"\\]",display:!0},{left:"$$",right:"$$",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"$",right:"$",display:!1}],throwOnError:!0})})</script></head><body id="
    top"><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="xiaruize's Blog (Alt + H)">xiaruize's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=http://localhost:1313/zh/ title=中文 aria-label=中文>Zh</a></li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">University Ranking Frontend Deep Dive (Part 1): Navigation Architecture & Search Implementation</h1><div class=post-description>Part 1 of our deep dive into the University Ranking Frontend. We explore the navigation orchestration in App.js, implement the SearchScreen with real-time filtering and bottom sheet modals, and build the DetailPage for university profiles.</div><div class=post-meta><span title='2025-12-07 00:00:00 +0000 UTC'>December 7, 2025</span>&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=http://localhost:1313/zh/post/university-ranking-frontend-part-1/>Zh</a></li></ul></div></header><div class=post-content><p>This is Part 1 of our University Ranking Frontend code deep dive. If you haven&rsquo;t read the http://localhost:1313/post/university-ranking-frontend/ introduction yet, I recommend starting there.</p><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>In Part 1, we&rsquo;ll explore:</p><ol><li><strong>Navigation Orchestration</strong> - How <code>App.js</code> orchestrates bottom tab and stack navigators</li><li><strong>SearchScreen Implementation</strong> - Building the main search interface with real-time filtering</li><li><strong>DetailPage Construction</strong> - Displaying comprehensive university profiles with dynamic content</li><li><strong>API Integration</strong> - Fetching data with axios and handling async operations</li></ol><h2 id=architecture-lesson-why-we-use-this-navigation-pattern>Architecture Lesson: Why We Use This Navigation Pattern<a hidden class=anchor aria-hidden=true href=#architecture-lesson-why-we-use-this-navigation-pattern>#</a></h2><p>Many developers overthink navigation. The University Ranking Frontend uses a simple but powerful pattern:</p><pre tabindex=0><code>Bottom Tabs
├── Home (Search)
│   └── Stack Navigator
│       ├── SearchScreen
│       ├── DetailPage
│       └── UniversitySourceRankingsPage
├── Subject Rankings
│   └── Stack Navigator
│       ├── SubjectRankingsPage
│       ├── RankingDetailPage
│       └── DetailPage
├── Favorites
│   └── Stack Navigator
│       └── FavoritesScreen
└── Me (Profile)
    └── Stack Navigator
        └── MeScreen
</code></pre><p><strong>Why this works:</strong></p><ul><li><strong>Bottom tabs</strong> provide persistent navigation between major app sections</li><li><strong>Stack navigators</strong> within each tab enable push/pop transitions for detail views</li><li><strong>Shared screens</strong> (DetailPage appears in multiple stacks) reuse components across contexts</li></ul><p>This is <strong>Vibe Coding in action</strong>: instead of inventing a custom navigation system, we use proven React Navigation patterns that AI can quickly suggest and improve.</p><h2 id=appjs-the-navigation-orchestrator>App.js: The Navigation Orchestrator<a hidden class=anchor aria-hidden=true href=#appjs-the-navigation-orchestrator>#</a></h2><p>Let&rsquo;s examine the root App.js file, which sets up the entire navigation hierarchy:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span><span class=p>,</span> <span class=p>{</span> <span class=nx>useState</span><span class=p>,</span> <span class=nx>useEffect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>NavigationContainer</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@react-navigation/native&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createBottomTabNavigator</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@react-navigation/bottom-tabs&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>createNativeStackNavigator</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@react-navigation/native-stack&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>BottomSheetModalProvider</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@gorhom/bottom-sheet&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>GestureHandlerRootView</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react-native-gesture-handler&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>QueryClient</span><span class=p>,</span> <span class=nx>QueryClientProvider</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@tanstack/react-query&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Initialize React Query Client
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>queryClient</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>QueryClient</span><span class=p>({</span>
</span></span><span class=line><span class=cl>	<span class=nx>defaultOptions</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>queries</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>staleTime</span><span class=o>:</span> <span class=mi>5</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span> <span class=c1>// 5 minutes
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=nx>cacheTime</span><span class=o>:</span> <span class=mi>10</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span> <span class=c1>// 10 minutes
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=nx>retry</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>refetchOnWindowFocus</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>Stack</span> <span class=o>=</span> <span class=nx>createNativeStackNavigator</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>Tab</span> <span class=o>=</span> <span class=nx>createBottomTabNavigator</span><span class=p>();</span>
</span></span></code></pre></div><p>Key configuration decisions:</p><ol><li><strong>Stale Time (5 minutes)</strong>: After 5 minutes, cached data is considered stale and React Query will refresh in the background</li><li><strong>Cache Time (10 minutes)</strong>: Keep cached data for 10 minutes before garbage collection</li><li><strong>Retry (2)</strong>: Automatically retry failed requests twice before showing an error</li><li><strong>refetchOnWindowFocus (false)</strong>: Don&rsquo;t refetch when the app regains focus (for better UX)</li></ol><p>This configuration is pragmatic: it balances responsiveness with network efficiency.</p><h3 id=home-stack-searchscreen>Home Stack (SearchScreen)<a hidden class=anchor aria-hidden=true href=#home-stack-searchscreen>#</a></h3><p>The Home stack is the primary navigation entry point:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>HomeScreen</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kr>const</span> <span class=p>{</span> <span class=nx>theme</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useTheme</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=o>&lt;</span><span class=nx>Stack</span><span class=p>.</span><span class=nx>Navigator</span>
</span></span><span class=line><span class=cl>			<span class=nx>screenOptions</span><span class=o>=</span><span class=p>{{</span>
</span></span><span class=line><span class=cl>				<span class=nx>headerStyle</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=nx>backgroundColor</span><span class=o>:</span> <span class=nx>theme</span><span class=p>.</span><span class=nx>surface</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=p>},</span>
</span></span><span class=line><span class=cl>				<span class=nx>headerTintColor</span><span class=o>:</span> <span class=nx>theme</span><span class=p>.</span><span class=nx>text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=nx>headerTitleStyle</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=nx>color</span><span class=o>:</span> <span class=nx>theme</span><span class=p>.</span><span class=nx>text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				<span class=p>},</span>
</span></span><span class=line><span class=cl>			<span class=p>}}</span>
</span></span><span class=line><span class=cl>		<span class=o>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=o>&lt;</span><span class=nx>Stack</span><span class=p>.</span><span class=nx>Screen</span>
</span></span><span class=line><span class=cl>				<span class=nx>name</span><span class=o>=</span><span class=s2>&#34;SearchScreen&#34;</span>
</span></span><span class=line><span class=cl>				<span class=nx>component</span><span class=o>=</span><span class=p>{</span><span class=nx>SearchScreen</span><span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=nx>options</span><span class=o>=</span><span class=p>{{</span> <span class=nx>headerShown</span><span class=o>:</span> <span class=kc>false</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>			<span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>			<span class=o>&lt;</span><span class=nx>Stack</span><span class=p>.</span><span class=nx>Screen</span>
</span></span><span class=line><span class=cl>				<span class=nx>name</span><span class=o>=</span><span class=s2>&#34;DetailPage&#34;</span>
</span></span><span class=line><span class=cl>				<span class=nx>component</span><span class=o>=</span><span class=p>{</span><span class=nx>UniversityDetail</span><span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=nx>options</span><span class=o>=</span><span class=p>{({</span> <span class=nx>route</span> <span class=p>})</span> <span class=p>=&gt;</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>					<span class=nx>title</span><span class=o>:</span> <span class=nx>route</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>name</span> <span class=o>||</span> <span class=nx>i18n</span><span class=p>.</span><span class=nx>t</span><span class=p>(</span><span class=s1>&#39;university_details&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>				<span class=p>})}</span>
</span></span><span class=line><span class=cl>			<span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>			<span class=o>&lt;</span><span class=nx>Stack</span><span class=p>.</span><span class=nx>Screen</span>
</span></span><span class=line><span class=cl>				<span class=nx>name</span><span class=o>=</span><span class=s2>&#34;UniversitySourceRankingsPage&#34;</span>
</span></span><span class=line><span class=cl>				<span class=nx>component</span><span class=o>=</span><span class=p>{</span><span class=nx>UniversitySourceRankingsPage</span><span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=nx>options</span><span class=o>=</span><span class=p>{({</span> <span class=nx>route</span> <span class=p>})</span> <span class=p>=&gt;</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>					<span class=nx>title</span><span class=o>:</span> <span class=nx>route</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>universityName</span> <span class=o>+</span> <span class=s1>&#39; &#39;</span> <span class=o>+</span> <span class=nx>formatSourceName</span><span class=p>(</span><span class=nx>route</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>source</span><span class=p>),</span>
</span></span><span class=line><span class=cl>				<span class=p>})}</span>
</span></span><span class=line><span class=cl>			<span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=o>&lt;</span><span class=err>/Stack.Navigator&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Key Pattern</strong>: The header styling is theme-aware. Whenever the user toggles dark mode, these colors update in real-time because we read from the <code>useTheme()</code> hook.</p><h3 id=context-provider-composition>Context Provider Composition<a hidden class=anchor aria-hidden=true href=#context-provider-composition>#</a></h3><p>App.js wraps the entire navigation tree with context providers:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>AppRoot</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=o>&lt;</span><span class=nx>QueryClientProvider</span> <span class=nx>client</span><span class=o>=</span><span class=p>{</span><span class=nx>queryClient</span><span class=p>}</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=o>&lt;</span><span class=nx>ThemeProvider</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>				<span class=o>&lt;</span><span class=nx>LanguageProvider</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>					<span class=o>&lt;</span><span class=nx>UniversityTranslationsProvider</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>						<span class=o>&lt;</span><span class=nx>RankingsProvider</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>							<span class=o>&lt;</span><span class=nx>AppContentInner</span> <span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>						<span class=o>&lt;</span><span class=err>/RankingsProvider&gt;</span>
</span></span><span class=line><span class=cl>					<span class=o>&lt;</span><span class=err>/UniversityTranslationsProvider&gt;</span>
</span></span><span class=line><span class=cl>				<span class=o>&lt;</span><span class=err>/LanguageProvider&gt;</span>
</span></span><span class=line><span class=cl>			<span class=o>&lt;</span><span class=err>/ThemeProvider&gt;</span>
</span></span><span class=line><span class=cl>		<span class=o>&lt;</span><span class=err>/QueryClientProvider&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Order matters:</strong></p><ol><li><strong>QueryClientProvider</strong> (outermost) - Manages all server state</li><li><strong>ThemeProvider</strong> - Provides color scheme to all components</li><li><strong>LanguageProvider</strong> - Provides language and translation functions</li><li><strong>UniversityTranslationsProvider</strong> - Provides cached university name translations</li><li><strong>RankingsProvider</strong> - Provides ranking options for filters</li></ol><p>Each provider is independent and can be tested in isolation.</p><h2 id=searchscreen-real-time-university-search>SearchScreen: Real-Time University Search<a hidden class=anchor aria-hidden=true href=#searchscreen-real-time-university-search>#</a></h2><p>The SearchScreen is the most complex component in the app. It implements:</p><ul><li>Real-time search with debouncing</li><li>Filter selection with bottom sheets</li><li>Animated loading spinner</li><li>Responsive layout with platform-specific adjustments</li></ul><h3 id=data-fetching-with-effects>Data Fetching with Effects<a hidden class=anchor aria-hidden=true href=#data-fetching-with-effects>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>SearchScreen</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>query</span><span class=p>,</span> <span class=nx>setQuery</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>country</span><span class=p>,</span> <span class=nx>setCountry</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>sortCredit</span><span class=p>,</span> <span class=nx>setSortCredit</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;QS_World_University_Rankings&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>results</span><span class=p>,</span> <span class=nx>setResults</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>([]);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>isLoading</span><span class=p>,</span> <span class=nx>setIsLoading</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Fetch universities when filters change
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nx>isMounted</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>fetchData</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isMounted</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nx>setIsLoading</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>searchUniversities</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>query</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>country</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>sort_credit</span><span class=o>:</span> <span class=nx>sortCredit</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isMounted</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span> <span class=c1>// Don&#39;t update if unmounted
</span></span></span><span class=line><span class=cl><span class=c1></span>                
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>cleaned</span> <span class=o>=</span> <span class=nx>data</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>u</span> <span class=p>=&gt;</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=p>...</span><span class=nx>u</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>country</span><span class=o>:</span> <span class=nx>u</span><span class=p>.</span><span class=nx>country</span> <span class=o>||</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>city</span><span class=o>:</span> <span class=nx>u</span><span class=p>.</span><span class=nx>city</span> <span class=o>||</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>}));</span>
</span></span><span class=line><span class=cl>                <span class=nx>setResults</span><span class=p>(</span><span class=nx>cleaned</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error fetching universities:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>isMounted</span><span class=p>)</span> <span class=nx>setResults</span><span class=p>([]);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>finally</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>isMounted</span><span class=p>)</span> <span class=nx>setIsLoading</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>fetchData</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>isMounted</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span> <span class=c1>// Prevent updates on unmounted component
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=p>[</span><span class=nx>query</span><span class=p>,</span> <span class=nx>country</span><span class=p>,</span> <span class=nx>sortCredit</span><span class=p>]);</span> <span class=c1>// Re-run when filters change
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><p><strong>Vibe Coding Pattern</strong>: The <code>isMounted</code> flag prevents memory leaks and race conditions. AI suggested this pattern because:</p><ul><li>Navigation can unmount a screen before async operations complete</li><li>Without <code>isMounted</code>, state updates on unmounted components cause warnings</li><li>This pattern is idiomatic for React hooks</li></ul><h3 id=bottom-sheet-modals-for-filters>Bottom Sheet Modals for Filters<a hidden class=anchor aria-hidden=true href=#bottom-sheet-modals-for-filters>#</a></h3><p>The SearchScreen uses bottom sheet modals for country and ranking selection:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>BottomSheetModal</span><span class=p>,</span> <span class=nx>BottomSheetScrollView</span><span class=p>,</span> <span class=nx>BottomSheetBackdrop</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@gorhom/bottom-sheet&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>countrySheetRef</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>rankingSheetRef</span> <span class=o>=</span> <span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>snapPoints</span> <span class=o>=</span> <span class=nx>useMemo</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>[</span><span class=s1>&#39;60%&#39;</span><span class=p>,</span> <span class=s1>&#39;75%&#39;</span><span class=p>,</span> <span class=s1>&#39;90%&#39;</span><span class=p>],</span> <span class=p>[]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Open country filter
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>handleCountryPress</span> <span class=o>=</span> <span class=nx>useCallback</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>setCountrySearchQuery</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>rankingSheetRef</span><span class=p>.</span><span class=nx>current</span><span class=o>?</span><span class=p>.</span><span class=nx>dismiss</span><span class=p>();</span> <span class=c1>// Close other sheet
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>countrySheetRef</span><span class=p>.</span><span class=nx>current</span><span class=o>?</span><span class=p>.</span><span class=nx>present</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>},</span> <span class=p>[]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Filter countries as user types
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>filteredCountryItems</span> <span class=o>=</span> <span class=nx>useMemo</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>countrySearchQuery</span><span class=p>)</span> <span class=k>return</span> <span class=nx>countryItems</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>countryItems</span><span class=p>.</span><span class=nx>filter</span><span class=p>(</span><span class=nx>item</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nx>item</span><span class=p>.</span><span class=nx>label</span><span class=p>.</span><span class=nx>toLowerCase</span><span class=p>().</span><span class=nx>includes</span><span class=p>(</span><span class=nx>countrySearchQuery</span><span class=p>.</span><span class=nx>toLowerCase</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>},</span> <span class=p>[</span><span class=nx>countryItems</span><span class=p>,</span> <span class=nx>countrySearchQuery</span><span class=p>]);</span>
</span></span></code></pre></div><p><strong>Key insight</strong>: Bottom sheets provide a native-like UX where filters are accessible but don&rsquo;t hide the main content. The <code>snapPoints</code> allow users to drag the sheet to different heights.</p><h3 id=search-results-display>Search Results Display<a hidden class=anchor aria-hidden=true href=#search-results-display>#</a></h3><p>The search results are displayed in a FlatList for efficient rendering of large lists:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>FlatList</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=o>=</span><span class=p>{</span><span class=nx>results</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>keyExtractor</span><span class=o>=</span><span class=p>{(</span><span class=nx>item</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>item</span><span class=p>.</span><span class=nx>normalized_name</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>renderItem</span><span class=o>=</span><span class=p>{({</span> <span class=nx>item</span> <span class=p>})</span> <span class=p>=&gt;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>TouchableOpacity</span>
</span></span><span class=line><span class=cl>            <span class=nx>onPress</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=nx>navigation</span><span class=p>.</span><span class=nx>navigate</span><span class=p>(</span><span class=s1>&#39;DetailPage&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>normalized_name</span><span class=o>:</span> <span class=nx>item</span><span class=p>.</span><span class=nx>normalized_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>name</span><span class=o>:</span> <span class=nx>item</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>country</span><span class=o>:</span> <span class=nx>item</span><span class=p>.</span><span class=nx>country</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>})}</span>
</span></span><span class=line><span class=cl>        <span class=o>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;</span><span class=nx>View</span> <span class=nx>style</span><span class=o>=</span><span class=p>{</span><span class=nx>styles</span><span class=p>.</span><span class=nx>resultItem</span><span class=p>}</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=o>&lt;</span><span class=nx>Text</span> <span class=nx>style</span><span class=o>=</span><span class=p>{</span><span class=nx>styles</span><span class=p>.</span><span class=nx>resultName</span><span class=p>}</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>item</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/Text&gt;</span>
</span></span><span class=line><span class=cl>                <span class=o>&lt;</span><span class=nx>Text</span> <span class=nx>style</span><span class=o>=</span><span class=p>{</span><span class=nx>styles</span><span class=p>.</span><span class=nx>resultLocation</span><span class=p>}</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span><span class=nx>item</span><span class=p>.</span><span class=nx>city</span><span class=p>},</span> <span class=p>{</span><span class=nx>item</span><span class=p>.</span><span class=nx>country</span><span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=o>&lt;</span><span class=err>/Text&gt;</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;</span><span class=err>/View&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=err>/TouchableOpacity&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>)}</span>
</span></span><span class=line><span class=cl>    <span class=nx>ListEmptyComponent</span><span class=o>=</span><span class=p>{()</span> <span class=p>=&gt;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>Text</span> <span class=nx>style</span><span class=o>=</span><span class=p>{</span><span class=nx>styles</span><span class=p>.</span><span class=nx>emptyText</span><span class=p>}</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=nx>isLoading</span> <span class=o>?</span> <span class=nx>i18n</span><span class=p>.</span><span class=nx>t</span><span class=p>(</span><span class=s1>&#39;searching&#39;</span><span class=p>)</span> <span class=o>:</span> <span class=nx>i18n</span><span class=p>.</span><span class=nx>t</span><span class=p>(</span><span class=s1>&#39;no_results&#39;</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=err>/Text&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>)}</span>
</span></span><span class=line><span class=cl><span class=err>/&gt;</span>
</span></span></code></pre></div><p><strong>Pattern</strong>: Using <code>normalized_name</code> as both the list key and the identifier passed to DetailPage ensures consistency across the app.</p><h2 id=detailpage-comprehensive-university-profiles>DetailPage: Comprehensive University Profiles<a hidden class=anchor aria-hidden=true href=#detailpage-comprehensive-university-profiles>#</a></h2><p>The DetailPage displays:</p><ul><li>University logo and basic information</li><li>Rankings across multiple sources</li><li>University description (dynamically translated if needed)</li><li>Favorite/unfavorite functionality</li><li>Links to detailed ranking breakdowns</li></ul><h3 id=async-data-loading>Async Data Loading<a hidden class=anchor aria-hidden=true href=#async-data-loading>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>GetUniversityDetail</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>normalized_name</span> <span class=o>=</span> <span class=nx>props</span><span class=p>.</span><span class=nx>route</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>normalized_name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>university</span><span class=p>,</span> <span class=nx>setUniversity</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>loading</span><span class=p>,</span> <span class=nx>setLoading</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>translatedBlurb</span><span class=p>,</span> <span class=nx>setTranslatedBlurb</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>translationLoading</span><span class=p>,</span> <span class=nx>setTranslationLoading</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>{</span> <span class=nx>isChinese</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useLanguage</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Fetch university details
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>normalized_name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>getUniversityDetails</span><span class=p>(</span><span class=nx>normalized_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>data</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>notFound</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nx>navigation</span><span class=p>.</span><span class=nx>goBack</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nx>setUniversity</span><span class=p>(</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=nx>setLoading</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=nx>checkIfFavorite</span><span class=p>(</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>})</span>
</span></span><span class=line><span class=cl>                <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>err</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error fetching details:&#39;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>setLoading</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=p>[</span><span class=nx>normalized_name</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Translate description when language changes
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>useEffect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nx>isMounted</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>translateBlurbIfNeeded</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>university</span> <span class=o>&amp;&amp;</span> <span class=nx>university</span><span class=p>.</span><span class=nx>blurb</span> <span class=o>&amp;&amp;</span> <span class=nx>isChinese</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>setTranslationLoading</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kr>const</span> <span class=nx>translated</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>translateText</span><span class=p>(</span><span class=nx>university</span><span class=p>.</span><span class=nx>blurb</span><span class=p>,</span> <span class=s1>&#39;en&#39;</span><span class=p>,</span> <span class=s1>&#39;zh-Hans&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=nx>isMounted</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nx>setTranslatedBlurb</span><span class=p>(</span><span class=nx>translated</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Translation failed:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>isMounted</span><span class=p>)</span> <span class=nx>setTranslatedBlurb</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>translateBlurbIfNeeded</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=nx>isMounted</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=p>[</span><span class=nx>university</span><span class=p>,</span> <span class=nx>isChinese</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Key Pattern</strong>: Translations are handled as a side effect when the language context changes. This keeps translation logic separate from component rendering.</p><h3 id=favorites-management-with-asyncstorage>Favorites Management with AsyncStorage<a hidden class=anchor aria-hidden=true href=#favorites-management-with-asyncstorage>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>checkIfFavorite</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>universityData</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>stored</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>AsyncStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;favoriteUniversities&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>stored</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>favorites</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>stored</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>isCurrentFavorite</span> <span class=o>=</span> <span class=nx>favorites</span><span class=p>.</span><span class=nx>some</span><span class=p>(</span><span class=nx>fav</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nx>fav</span><span class=p>.</span><span class=nx>normalized_name</span> <span class=o>===</span> <span class=nx>universityData</span><span class=p>.</span><span class=nx>normalized_name</span> <span class=o>||</span>
</span></span><span class=line><span class=cl>                <span class=nx>fav</span><span class=p>.</span><span class=nx>id</span> <span class=o>===</span> <span class=nx>universityData</span><span class=p>.</span><span class=nx>id</span>
</span></span><span class=line><span class=cl>            <span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>setIsFavorite</span><span class=p>(</span><span class=nx>isCurrentFavorite</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error checking favorites:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>toggleFavorite</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>university</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>setFavoriteLoading</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>stored</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>AsyncStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;favoriteUniversities&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nx>favorites</span> <span class=o>=</span> <span class=nx>stored</span> <span class=o>?</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>stored</span><span class=p>)</span> <span class=o>:</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>favoriteData</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>id</span><span class=o>:</span> <span class=nx>university</span><span class=p>.</span><span class=nx>id</span> <span class=o>||</span> <span class=nx>university</span><span class=p>.</span><span class=nx>normalized_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>normalized_name</span><span class=o>:</span> <span class=nx>university</span><span class=p>.</span><span class=nx>normalized_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>name</span><span class=o>:</span> <span class=nx>university</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>country</span><span class=o>:</span> <span class=nx>university</span><span class=p>.</span><span class=nx>country</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>city</span><span class=o>:</span> <span class=nx>university</span><span class=p>.</span><span class=nx>city</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>photo</span><span class=o>:</span> <span class=nx>university</span><span class=p>.</span><span class=nx>photo</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>isFavorite</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Remove from favorites
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>favorites</span> <span class=o>=</span> <span class=nx>favorites</span><span class=p>.</span><span class=nx>filter</span><span class=p>(</span><span class=nx>fav</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nx>fav</span><span class=p>.</span><span class=nx>normalized_name</span> <span class=o>!==</span> <span class=nx>university</span><span class=p>.</span><span class=nx>normalized_name</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>                <span class=nx>fav</span><span class=p>.</span><span class=nx>id</span> <span class=o>!==</span> <span class=nx>university</span><span class=p>.</span><span class=nx>id</span>
</span></span><span class=line><span class=cl>            <span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>setIsFavorite</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Add to favorites
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>favorites</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>favoriteData</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>setIsFavorite</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>AsyncStorage</span><span class=p>.</span><span class=nx>setItem</span><span class=p>(</span><span class=s1>&#39;favoriteUniversities&#39;</span><span class=p>,</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>favorites</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>updateFavoriteCount</span><span class=p>(</span><span class=nx>favorites</span><span class=p>.</span><span class=nx>length</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error updating favorites:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>finally</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setFavoriteLoading</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p><strong>Vibe Coding insight</strong>: Rather than syncing favorites to the backend, we store them locally with AsyncStorage. This provides:</p><ul><li>Instant feedback (no network delay)</li><li>Works offline</li><li>Reduces server load</li></ul><p>The <code>favoriteLoading</code> state ensures the UI shows loading state during the toggle operation.</p><h2 id=api-integration-the-libapijs-layer>API Integration: The lib/api.js Layer<a hidden class=anchor aria-hidden=true href=#api-integration-the-libapijs-layer>#</a></h2><p>The API layer separates API calls from components:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>API_BASE_URL</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;../constants/config&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>axios</span> <span class=nx>from</span> <span class=s1>&#39;axios&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>rawApi</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>searchUniversities</span><span class=p>({</span> <span class=nx>query</span><span class=p>,</span> <span class=nx>country</span><span class=p>,</span> <span class=nx>city</span><span class=p>,</span> <span class=nx>sort_credit</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>API_BASE_URL</span><span class=si>}</span><span class=sb>/universities/filter`</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>params</span><span class=o>:</span> <span class=p>{</span> <span class=nx>query</span><span class=p>,</span> <span class=nx>country</span><span class=p>,</span> <span class=nx>city</span><span class=p>,</span> <span class=nx>sort_credit</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>response</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>getUniversityDetails</span><span class=p>(</span><span class=nx>normalizedName</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>API_BASE_URL</span><span class=si>}</span><span class=sb>/universities/</span><span class=si>${</span><span class=nx>normalizedName</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span> <span class=o>!==</span> <span class=mi>200</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=sb>`Failed to fetch: </span><span class=si>${</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>response</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>translateText</span><span class=p>(</span><span class=nx>text</span><span class=p>,</span> <span class=nx>from</span><span class=p>,</span> <span class=nx>to</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>API_BASE_URL</span><span class=si>}</span><span class=sb>/translate`</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>from_lang</span><span class=o>:</span> <span class=nx>from</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>to_lang</span><span class=o>:</span> <span class=nx>to</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>response</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>translatedText</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Export functions for direct use
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=kr>const</span> <span class=nx>searchUniversities</span> <span class=o>=</span> <span class=nx>rawApi</span><span class=p>.</span><span class=nx>searchUniversities</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>getUniversityDetails</span> <span class=o>=</span> <span class=nx>rawApi</span><span class=p>.</span><span class=nx>getUniversityDetails</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>translateText</span> <span class=o>=</span> <span class=nx>rawApi</span><span class=p>.</span><span class=nx>translateText</span><span class=p>;</span>
</span></span></code></pre></div><p><strong>Benefits of this pattern:</strong></p><ul><li><strong>Testability</strong>: Easy to mock <code>rawApi</code> for unit tests</li><li><strong>Reusability</strong>: API functions can be used directly or wrapped with React Query</li><li><strong>Maintainability</strong>: All API calls in one place</li></ul><h2 id=design-insights-from-vibe-coding>Design Insights from Vibe Coding<a hidden class=anchor aria-hidden=true href=#design-insights-from-vibe-coding>#</a></h2><h3 id=1-real-time-search-is-easier-than-debouncing>1. Real-Time Search is Easier Than Debouncing<a hidden class=anchor aria-hidden=true href=#1-real-time-search-is-easier-than-debouncing>#</a></h3><p>Initially, debouncing the search seemed necessary to reduce API calls. However, the backend filter endpoint is fast, and the network is reliable. So we skip debouncing and let the user see instant results. <strong>This is Vibe Coding</strong>: pragmatic choices over theoretical optimization.</p><h3 id=2-bottom-sheets--modal-dialogs>2. Bottom Sheets > Modal Dialogs<a hidden class=anchor aria-hidden=true href=#2-bottom-sheets--modal-dialogs>#</a></h3><p>Native-like bottom sheets provide better UX than centered modals because:</p><ul><li>Users can see content behind the sheet</li><li>Dragging to dismiss feels natural</li><li>Screen real estate is used efficiently</li></ul><p>AI suggested <code>@gorhom/bottom-sheet</code> because it provides smooth animations and gesture handling.</p><h3 id=3-context--asyncstorage--redux-for-preferences>3. Context + AsyncStorage > Redux for Preferences<a hidden class=anchor aria-hidden=true href=#3-context--asyncstorage--redux-for-preferences>#</a></h3><p>Managing favorites locally with AsyncStorage and React Context is simpler than:</p><ul><li>Redux + Redux Persist</li><li>Syncing to backend</li><li>Complex state management</li></ul><p>Vibe Coding helped us recognize that not everything needs to be in global state.</p><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p>In Part 1, we explored:</p><ul><li>✅ How navigation is orchestrated in App.js with bottom tabs and stack navigators</li><li>✅ Building SearchScreen with real-time filtering and bottom sheet modals</li><li>✅ Implementing DetailPage with async data loading and favorites management</li><li>✅ Structuring API calls for reusability and testability</li></ul><p>In http://localhost:1313/post/university-ranking-frontend-part-2/, we&rsquo;ll deep dive into:</p><ul><li>Context implementations (ThemeContext, LanguageContext, RankingsProvider)</li><li>React Query patterns for sophisticated data management</li><li>Component styling patterns for theme awareness</li><li>Platform-specific considerations</li></ul><p>The key takeaway: <strong>Good navigation architecture enables clean component design</strong>. By handling navigation concerns in App.js, individual screens can focus on their specific responsibilities—searching, displaying, and managing data.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/react-native/>React Native</a></li><li><a href=http://localhost:1313/tags/navigation/>Navigation</a></li><li><a href=http://localhost:1313/tags/search/>Search</a></li><li><a href=http://localhost:1313/tags/vibe-coding/>Vibe Coding</a></li><li><a href=http://localhost:1313/tags/implementation/>Implementation</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>xiaruize's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>